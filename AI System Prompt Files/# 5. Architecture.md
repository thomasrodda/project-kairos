## 1. Frontend

**Framework**: React

**Language**: TypeScript

**Styling**: Custom SCSS (not using Tailwind or shadcn/ui)

**Structure**: Organized by features, with dedicated components/, styles/, hooks/, and utils/ folders under apps/web/src

**Editor Architecture**: **Custom block-based editor built from scratch**

- Provides full control over block behavior, slash commands, and AI integration
- Each block is an independent React component with its own state and behavior
- Plugin-friendly architecture for easy addition of new block types
- Supports live markdown formatting and cross-app compatibility

## 2. Backend

**Type**: Serverless Functions

**Provider**: Vercel Functions

**Design**: Modular endpoints under apps/api/, each function in its own file

**Limits**: 10-second execution time per function (on free tier)

**Fallback Plan**: Offload longer-running AI tasks to AWS Lambda if needed

## 3. Authentication

**Service**: Firebase Authentication

**Method**: Google OAuth login

**Flow**: Frontend uses Firebase SDK to authenticate, sends ID token to Vercel backend for verification

**Implementation**: Added after basic UI is functional to allow for early testing and iteration

## 4. Data Storage

**Primary**: Cloud-first with real-time sync

**Database**: PostgreSQL or MongoDB (TBD based on data structure needs)

**Optional**: Local-first storage as user preference for offline capability

**Sync Strategy**: Debounced autosave with conflict resolution

## 5. Hosting

**Platform**: Vercel

**Frontend and backend**: Deployed together for simplicity

**Edge caching and CDN**: Provided by Vercel

## 6. Updated Folder Structure

```
project-root/
├── apps/
│   ├── web/
│   │   ├── public/
│   │   ├── src/
│   │   │   ├── components/
│   │   │   │   ├── Editor/           # Custom block-based editor
│   │   │   │   │   ├── Block/        # Individual block components
│   │   │   │   │   ├── SlashMenu/    # Slash command interface
│   │   │   │   │   ├── Toolbar/      # Formatting toolbar
│   │   │   │   │   └── Editor.tsx    # Main editor component
│   │   │   │   ├── Layout/           # App layout components
│   │   │   │   ├── Sidebar/          # Navigation and file tree
│   │   │   │   └── Auth/             # Authentication components
│   │   │   ├── hooks/                # Custom React hooks
│   │   │   │   ├── useBlocks.ts      # Block management logic
│   │   │   │   ├── useMarkdown.ts    # Markdown parsing/export
│   │   │   │   └── useEditor.ts      # Editor state management
│   │   │   ├── utils/
│   │   │   │   ├── markdown.ts       # Markdown processing utilities
│   │   │   │   ├── blocks.ts         # Block manipulation utilities
│   │   │   │   └── formatting.ts     # Text formatting helpers
│   │   │   ├── styles/
│   │   │   │   ├── components/       # Component-specific styles
│   │   │   │   ├── layout/           # Layout and grid styles
│   │   │   │   └── themes/           # Light/dark theme support
│   │   │   └── types/                # Frontend-specific types
│   │   ├── tsconfig.json
│   │   └── package.json
│   └── api/
│       ├── auth/                     # Authentication endpoints
│       ├── blocks/                   # Block CRUD operations
│       ├── pages/                    # Page management
│       ├── workspaces/               # Workspace operations
│       └── vercel.json
├── packages/
│   ├── ui/                           # Shared UI components
│   ├── utils/                        # Cross-platform utilities
│   └── types/                        # Shared TypeScript types
├── .eslintrc.cjs
├── .prettierrc
├── tsconfig.json
├── package.json
└── README.md
```

## 7. Tooling

**Linting**: ESLint (configured for TypeScript + React)

**Formatting**: Prettier

**Type Checking**: TypeScript (with shared config)

**Pre-commit hooks**: Husky + lint-staged for code quality enforcement

**Testing**: Jest for unit tests, Cypress for end-to-end testing

## 8. Custom Editor Architecture Details

### Block System Design

- **Block Registry**: Central configuration for all block types
- **Block Components**: Individual React components for each block type (TextBlock, HeadingBlock, BulletBlock)
- **Block State Management**: Each block manages its own content and formatting state
- **Block Communication**: Event system for inter-block operations (focus, deletion, creation)

### Markdown Integration

- **Live Formatting**: Real-time detection of markdown syntax during typing
- **Parser/Serializer**: Bidirectional conversion between blocks and markdown
- **Paste Handler**: Intelligent detection and conversion of pasted markdown content
- **Export System**: Clean markdown output maintaining formatting and structure

### Extensibility Patterns

- **Plugin Architecture**: New block types can be added without modifying core editor
- **Event Bus**: Decoupled communication between editor components
- **Hook-based State**: React hooks for reusable editor logic
- **Type Safety**: Full TypeScript support for all editor operations

## 9. Rationale for Key Decisions

**Custom Editor**: Necessary for precise block behavior, slash commands, and future AI integration

**UI-First Development**: Allows for immediate visual feedback and iteration on user experience

**React + TypeScript**: Large ecosystem, strong typing, excellent development experience

**SCSS over Tailwind**: More powerful styling system, better component encapsulation

**Serverless on Vercel**: Simple deployment, fast iteration, automatic scaling

**Firebase Auth**: Mature, secure authentication with minimal setup complexity

**Phase-based Development**: Reduces complexity, enables early testing, supports iterative improvement

## 10. Performance Considerations

**Editor Performance**:

- React.memo for block components to prevent unnecessary re-renders
- Virtualization for documents with many blocks
- Debounced autosave to reduce server load
- Efficient block reordering with optimized drag-and-drop

**Bundle Optimization**:

- Code splitting for non-critical features
- Lazy loading of formatting and advanced features
- Tree shaking for unused code elimination
- Separate bundles for editor vs. authentication components

## 11. Extensibility Practices

- **Block system**: Designed to be pluggable for future block types (images, tables, embeds)
- **AI features**: Abstracted behind shared interfaces for easy provider switching
- **Markdown support**: Extensible parser for additional markdown features
- **Theme system**: Prepared for light/dark modes and custom themes
- **Utility packages**: Colocated under `packages/` for cross-platform reuse
